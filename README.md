# YT-Scribe

A lightweight Node.js application that fetches YouTube video transcripts and metadata without requiring an official YouTube API key or heavy browser automation.

## Features

- **Transcript Fetching**: Retrieves transcripts from YouTube videos using internal API methods.
- **Multi-Language Support**: Automatically detects available caption tracks and allows fetching specific languages.
- **Metadata Extraction**: Fetches video title, author, and thumbnail via OEmbed.
- **Robust Parsing**: Handles XML parsing, HTML entity decoding, and time synchronization for captions.
- **SPA Fallback**: Serves a single-page application frontend for user interaction.

## Tech Stack

- **Backend**: Node.js, Express
- **HTTP Client**: `undici` (for efficient fetching)
- **Frontend**: Vanilla HTML/CSS/JavaScript

## Installation

1. Clone the repository:
   ```bash
   git clone <repository-url>
   cd yt-transcript
   ```

2. Install dependencies:
   ```bash
   npm install
   ```

3. Start the server:
   ```bash
   npm start
   ```
   or for development:
   ```bash
   npm run dev
   ```

4. Open your browser and navigate to `http://localhost:3000`.

## API Endpoints

### 1. Get Video Metadata

Returns basic information about a YouTube video.

**Endpoint:** `GET /api/metadata`

**Query Parameters:**
- `url` (or `videoId`): The full YouTube video URL or ID.

**Response:**
```json
{
  "videoId": "dQw4w9WgXcQ",
  "title": "Rick Astley - Never Gonna Give You Up (Official Music Video)",
  "author": "Rick Astley",
  "thumbnail": "https://img.youtube.com/vi/dQw4w9WgXcQ/hqdefault.jpg"
}
```

### 2. Get Transcript

Returns the transcript segments for a video.

**Endpoint:** `GET /api/transcript`

**Query Parameters:**
- `url` (or `videoId`): The full YouTube video URL or ID.
- `lang` (optional): The language code (e.g., `en`, `es`) to fetch. If omitted, defaults to the first available non-auto-generated track, or auto-generated if no manual captions exist.

**Response:**
```json
{
  "videoId": "dQw4w9WgXcQ",
  "language": "en",
  "languageName": "English",
  "isAutoGenerated": false,
  "availableLanguages": [
    { "code": "en", "name": "English", "isAutoGenerated": false },
    ...
  ],
  "segments": [
    {
      "text": "We're no strangers to love",
      "offset": 0,
      "duration": 2500
    },
    ...
  ]
}
```

## How It Works

The application bypasses the need for an official API key by:
1. Fetching the video page HTML to extract the `INNERTUBE_API_KEY`.
2. Using the extracted key and client context to query the internal YouTube API (`/youtubei/v1/player`).
3. Parsing the returned JSON to find caption tracks.
4. Fetching the XML transcript file from the caption track URL.
5. Parsing XML into a clean JSON format with timestamps.

## License

MIT
